<html>
<head><title>RESPONSE FUNCTION variables.</title>
<link rel=stylesheet type="text/css" href="formabinit.css">
</head>
<body bgcolor="#ffffff">

<hr>
<a name="top"></a>

<h1>ABINIT, response function input variables:</h1>
<h2>List and description.</h2>

<hr>

<br>This document lists and provides the description
of the name (keywords) of the response function input
variables to be used in the main input file of the abinit code.

<br>The new user is advised to read first the
  <a href="../users/new_user_guide.html">new user's guide</a>,
  before reading the present file. It will be easier to discover the
  present file with the help of the <a href="../tutorial/welcome.html">tutorial</a>.

<br>When the user is sufficiently familiarized with ABINIT, the reading of the
  ~abinit/doc/users/tuning file might be useful. For response-function calculations using
  abinit, please read <a href="../users/respfn_help.html">the response function help file</a>

<h5>Copyright (C) 1998-2014 ABINIT group (DCA, XG, RC)
<br> This file is distributed under the terms of the GNU General Public License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br> For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>

<script type="text/javascript" src="list_internal_links.js"> </script>

<script type="text/javascript" src="list_htmlfiles_input_variables.js"> </script>

<h3><b> Content of the file : alphabetical list of variables.</b></h3>
 <br>A.
 <br>B.
 <a href="varrf.html#bdeigrf">bdeigrf</a>&nbsp;&nbsp;
 <br>C.
 <br>D.
 <br>E.
 <a href="varrf.html#elph2_imagden">elph2_imagden</a>&nbsp;&nbsp;
 <a href="varrf.html#esmear">esmear</a>&nbsp;&nbsp;
 <br>F.
 <a href="varrf.html#frzfermi">frzfermi</a>&nbsp;&nbsp;
 <br>G.
 <br>H.
 <br>I.
 <a href="varrf.html#ieig2rf">ieig2rf</a>&nbsp;&nbsp;
 <br>J.
 <br>K.
 <br>M.
 <a href="varrf.html#mkqmem">mkqmem</a>&nbsp;&nbsp;
 <a href="varrf.html#mk1mem">mk1mem</a>&nbsp;&nbsp;
 <br>N.
 <br>O.
 <br>P.
 <a href="varrf.html#prepanl">prepanl</a>&nbsp;&nbsp;
 <a href="varrf.html#prepgkk">prepgkk</a>&nbsp;&nbsp;
 <a href="varrf.html#prtbbb">prtbbb</a>&nbsp;&nbsp;
 <br>Q.
 <br>R.
 <a href="varrf.html#rfasr">rfasr</a>&nbsp;&nbsp;
 <a href="varrf.html#rfatpol">rfatpol</a>&nbsp;&nbsp;
 <a href="varrf.html#rfddk">rfddk</a>&nbsp;&nbsp;
 <a href="varrf.html#rfdir">rfdir</a>&nbsp;&nbsp;
 <a href="varrf.html#rfelfd">rfelfd</a>&nbsp;&nbsp;
 <a href="varrf.html#rfmeth">rfmeth</a>&nbsp;&nbsp;
 <a href="varrf.html#rfphon">rfphon</a>&nbsp;&nbsp;
 <a href="varrf.html#rfstrs">rfstrs</a>&nbsp;&nbsp;
 <a href="varrf.html#rfuser">rfuser</a>&nbsp;&nbsp;
 <a href="varrf.html#rf1atpol">rf1atpol</a>&nbsp;&nbsp;
 <a href="varrf.html#rf1dir">rf1dir</a>&nbsp;&nbsp;
 <a href="varrf.html#rf1elfd">rf1elfd</a>&nbsp;&nbsp;
 <a href="varrf.html#rf1phon">rf1phon</a>&nbsp;&nbsp;
 <a href="varrf.html#rf2atpol">rf2atpol</a>&nbsp;&nbsp;
 <a href="varrf.html#rf2dir">rf2dir</a>&nbsp;&nbsp;
 <a href="varrf.html#rf2elfd">rf2elfd</a>&nbsp;&nbsp;
 <a href="varrf.html#rf2phon">rf2phon</a>&nbsp;&nbsp;
 <a href="varrf.html#rf3atpol">rf3atpol</a>&nbsp;&nbsp;
 <a href="varrf.html#rf3dir">rf3dir</a>&nbsp;&nbsp;
 <a href="varrf.html#rf3elfd">rf3elfd</a>&nbsp;&nbsp;
 <a href="varrf.html#rf3phon">rf3phon</a>&nbsp;&nbsp;
 <br>S.
 <a href="varrf.html#sciss">sciss</a>&nbsp;&nbsp;
 <a href="varrf.html#smdelta">smdelta</a>&nbsp;&nbsp;
 <br>T.
 <a href="varrf.html#td_maxene">td_maxene</a>&nbsp;&nbsp;
 <a href="varrf.html#td_mexcit">td_mexcit</a>&nbsp;&nbsp;
 <br>U.
 <br>V.
 <br>W.
 <br>X.
 <br>Y.
 <br>Z.

<br><br><br><br><hr>

<br><font id="title"><a name="frzfermi">frzfermi</a></font>
<br><font id="definition">Mnemonics: FReeZe FERMI energy</font>
<br><font id="category">Characteristic:         </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
Can be used to suppress artificially the first-order change of
Fermi energy, in case of Response Function calculation
for metals at Q=0. This change is needed, but was not computed prior to v4.4 .
Its calculation has been implemented by DHamann. The input variable <b>frzfermi</b>,
if set to 1, allows to recover the previous, incorrect behaviour.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="bdeigrf">bdeigrf</a></font>
<br><font id="definition">Mnemonics: BanD for second-order EIGenvalues from Response-Function </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameters </font>
<br><font id="default">Default is -1.</font>
<br><font id="text">
<p>
Only relevant if <a href="varrf.html#ieig2rf">ieig2rf</a> = 1, 2, 3 or 4 that is, if the user is performing second-order eigenvalue calculations using response-functions.
<br><br>
The variable <b>bdeigrf</b> is the maximum number of bands for which the second-order eigenvalues must be calculated: the full number of bands is still used during the computation of these corrections.
<br><br>
If <b>bdeigrf</b> is set to -1, the code will automatically set <b>bdeigrf</b> equal to nband.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="elph2_imagden">elph2_imagden</a></font><br>
<br><font id="definition">Mnemonics: ELectron-PHonon interaction at 2nd order : IMAGina y shoft of the DENominator </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>,'<a href="../users/abinit_help.html#dimensions">ENERGY</a>'</font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.0 Ha.</font>
<br><font id="text"> 
<p>
Only relevant if <a href="varrf.html#ieig2rf">ieig2rf</a> is non-zero, that is, if the user is performing performing second-order eigenvalue calculations using response-functions. <br><br>The variable <b>elph2_imagden</b> determines the imaginary shift of the denominator of the sum-over-states
in the perturbation denominator, (e_{nk}-e_{n'k'}+i <b>elph2_imagden</b>).
One should use a width comparable with the Debye frequency or the maximum phonon frequency.<br>Can be 
specified in Ha (the default), Ry, eV or Kelvin, since
<b>ecut</b> has the
'<a href="../users/abinit_help.html#dimensions">ENERGY</a>' characteristics.
(1 Ha=27.2113845 eV)
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="esmear">esmear</a></font>
<br><font id="definition">Mnemonics: Eigenvalue SMEARing </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>,'<a href="../users/abinit_help.html#dimensions">ENERGY</a>'   </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.04 Ha.</font>
<br><font id="text">
<p>
Only relevant if <a href="varrf.html#smdelta">smdelta</a> = 1-5, that is, if the user is performing simulations of the electronic lifetimes induced by the electron-phonon coupling.
<br><br>
The variable <b>esmear</b> determines the width of the functions approximating the delta function, \delta(e_{nk}-e_{n'k'}),
 present in the expression of the lifetimes. One should use a width comparable with the Debye frequency or the maximum phonon frequency.<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since
<b>ecut</b> has the
'<a href="../users/abinit_help.html#dimensions">ENERGY</a>' characteristics.
(1 Ha=27.2113845 eV) 
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="ieig2rf">ieig2rf</a></font>
<br><font id="definition">Mnemonics: Integer for second-order EIGenvalues from Response-Function </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameters  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
If <b>ieig2rf</b> is greater then 0, the code will produce a file, named with the trailing suffix _EIGR2D, containing the second-order electronic eigenvalues for the perturbation. These files are used in the calculation of the thermal correction to the electronic eigenvalues.
<br><br>
If <b>ieig2rf</b> is set to 1, the second-order electronic eigenvalues will be calculated from the DFPT method (Sternheimer). <br>
If <b>ieig2rf</b> is set to 2, the second-order electronic eigenvalues will be calculated from the Allen-Cardona method. (sum over states) <br>
If <b>ieig2rf</b> is set to 3, the second-order electronic eigenvalues will be calculated from the DFPT method (sum over states) but using a different part of the code. This is equivalent to <b>ieig2rf</b> = 1 [debuging] <br>
If <b>ieig2rf</b> is set to 4, the second-order electronic eigenvalues will be calculated from the dynamical DFPT method (Sternheimer).
<br>Related variables : <a href="varrf.html#bdeigrf">bdeigrf</a>,<a href="varrf.html#elph2_imagden">elph2_imagden</a>,<a href="vardev.html#getgam_eig2nkq">getgam_eig2nkq</a>,<a href="varrf.html#smdelta">smdelta</a> 
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="mkqmem">mkqmem</a></font>
<br><font id="definition">Mnemonics: Maximum number of K+Q - points in MEMory </font>
<p>
<br><font id="title"><a name="mk1mem">mk1mem</a></font>
<br><font id="definition">Mnemonics: Maximum number of K - points for 1st order wavefunctions, kept in MEMory </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameters  </font>
<br><font id="default">Default is <a href="varbas.html#nkpt">nkpt</a>, i.e. in-core solution.</font>
<br><font id="text">
<p>
Plays a role similar to <a href="varfil.html#mkmem">mkmem</a>
but for different sets of wavefunctions : the
ground state wavefunctions at k+q and the first-order
wavefunctions. Only needed for response calculations.
<br>Internal representation as mkmems(2) and mkmems(3).
<br>Note (991019) that although the effective number of k points
can be reduced thanks to symmetry for different
perturbations, <b>mkqmem</b> and <b>mk1mem</b> are presently
still compared with the input <a href="varbas.html#nkpt">nkpt</a>. This should be changed
later.</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="prepanl">prepanl</a></font>
<br><font id="definition">Mnemonics: PREPAre Non-Linear response calculation </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
The computation of third-order derivatives from the 2n+1 theorem
requires the first-order wavefunctions and densities obtained from
a linear response calculation. The standard approach in a linear
response calculation is (i) to compute only the
irreducible perturbations, and (ii) to use symmetries to
reduce the number of k-points for the k-point integration.
<br>This approach cannot be applied, presently (v4.1),
if the first-order wavefunctions are to be used to compute third-order derivatives.
First, for electric fields, the code needs the derivatives
along the three directions. Still, in case of phonons, only the
irreducible perturbations are required.
Second, for both electric fields and phonons, the wavefunctions
must be available in half the BZ (kptopt=2), or the full BZ (kptopt=3).
<br>During the linear response calculation, in order to prepare a non-linear
calculation, one should put <b>prepanl</b> to 1 in order
to force ABINIT (i) to compute the electric field perturbation
along the three directions explicitly, and (ii) to keep the full number of k-points.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="prepgkk">prepgkk</a></font>
<br><font id="definition">Mnemonics: PREPAre GKK calculation</font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
The calculation of electron-phonon coupling quantities requires the presence
of all the perturbations (all atoms in all directions) for the chosen set
of (irreducible) q-points. To impose this and prevent ABINIT from using
symmetry to reduce the number of perturbations, set <b>prepgkk</b> to 1.
Use in conjunction with <a href="varfil.html#prtgkk"><b>prtgkk</b></a>.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="prtbbb">prtbbb</a></font>
<br><font id="definition">Mnemonics: PRinT Band-By-Band decomposition </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
If <b>prtbbb</b> is 1, print the band-by-band decomposition of
Born effective charges and localization tensor, in case they are computed.
See Ph. Ghosez and X. Gonze, J. Phys.: Condens. Matter 12, 9179 (2000).
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfasr">rfasr</a></font>
<br><font id="definition">Mnemonics: Response Function : Acoustic Sum Rule </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
Control the evaluation of the
acoustic sum rule in effective charges and dynamical matrix at Gamma
within a response function calculation (not active at the level of producing the DDB, but
at the level of the phonon eigenfrequencies output). 
<ul>
<li>0 => no acoustic sum rule imposed</li>
<li>1 => acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with
extra charge evenly distributed among atoms</li>
<li>2 => acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with
extra charge given proportionally to those atoms with
the largest effective charge.</li>
</ul>
The treatment of the acoustic sum rule and charge neutrality sum rule is finer at the level of the ANADDB utility,
with the two independent input variables <a href="../users/anaddb_help.html#asr">asr</a>
and <a href="../users/anaddb_help.html#chneut">chneut</a>.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfatpol">rfatpol</a></font>
<br><font id="definition">Mnemonics: Response Function : limits of ATomic POLarisations </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<p>
<br><font id="title"><a name="rf1atpol">rf1atpol</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 1st mixed perturbation : limits of ATomic POLarisations </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf2atpol">rf2atpol</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 2nd mixed perturbation : limits of ATomic POLarisations </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf3atpol">rf3atpol</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 3rd mixed perturbation : limits of ATomic POLarisations </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="vartype">Variable type: integer array of 2 elements  </font>
<br><font id="default">Default is 1 1</font>
<br><font id="text">
<p>
Control the range
of atoms for which displacements will be considered
in phonon calculations (atomic polarisations), or in non-linear
computations, using the 2n+1 theorem.
<br>These values are only relevant to phonon response function
calculations, or non-linear computations.
<br>May take values from 1 to <a href="varbas.html#natom">natom</a>, with <b>rfatpol</b>(1)&lt;=<b>rfatpol</b>(2).
<br>The atoms to be moved will be defined by the
<br>do-loop variable iatpol :
<br>do iatpol=<b>rfatpol</b>(1),<b>rfatpol</b>(2)
<br>For the calculation of a full dynamical matrix, use
<b>rfatpol</b>(1)=1 and <b>rfatpol</b>(2)=<a href="varbas.html#natom">natom</a>, together with
<a href="varrf.html#rfdir">rfdir</a> 1 1 1 . For selected elements of the
dynamical matrix, use different values of <b>rfatpol</b> and/or
<a href="varrf.html#rfdir">rfdir</a>. The name 'iatpol' is used for the part of the
internal variable ipert when it runs from 1 to <a href="varbas.html#natom">natom</a>. The
internal variable ipert can also assume values larger
than <a href="varbas.html#natom">natom</a>, 
denoting perturbations of electric field or stress type (see <a href="../users/respfn_help.html">the response function help file</a>).</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="rfddk">rfddk</a></font>
<br><font id="definition">Mnemonics: Response Function with respect to Derivative with respect to K </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<p>

<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
Activates computation of derivatives of ground state
wavefunctions with respect to wavevectors. This is not strictly a response
function but is a needed auxiliary quantity in the electric field
calculations (see <a href="varrf.html#rfelfd">rfelfd</a>) The directions for the
derivatives are determined by <a href="varrf.html#rfdir">rfdir</a>.
<ul>
<li>0=>no derivative calculation</li>
<li>1=>calculation of first derivatives of wavefunctions with respect to k points 
(d/dk calculation). The exact same functionality is provided by 
<a href="varrf.html#rfelfd">rfelfd</a> = 2.
</li>
</ul>
</font>
<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfdir">rfdir</a></font>
<br><font id="definition">Mnemonics: Response Function : DIRections </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<p>
<br><font id="title"><a name="rf1dir">rf1dir</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 1st mixed perturbation : DIRections </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf2dir">rf2dir</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 2nd mixed perturbation : DIRections </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf3dir">rf3dir</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 3rd mixed perturbation : DIRections </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="vartype">Variable type: integer array of 3 elements  </font>
<br><font id="default">Default is 0 0 0.</font>
<br><font id="text">
<p>
Gives the directions
to be considered for response function calculations, or non-linear computations
(also for the Berry phase computation of the polarization, see
the <a href="varff.html#berryopt">berryopt</a> input variable).
<br>The three elements corresponds to the three primitive
vectors, either in real space (phonon calculations),
or in reciprocal space (d/dk, homogeneous electric field, homogeneous magnetic field
calculations). So, they generate a basis
for the generation of the dynamical matrix or
the macroscopic dielectric tensor or magnetic susceptibility and magnetic
shielding, or the effective
charge tensors.
<br>If equal to 1, response functions, as defined
by <a href="varrf.html#rfddk">rfddk</a>, 
<a href="varrf.html#rfelfd">rfelfd</a>, <a href="varrf.html#rfphon">rfphon</a>, <b>rfdir</b>
and <a href="varrf.html#rfatpol">rfatpol</a>, are to be computed
for the corresponding direction. If 0, this direction
should not be considered (for non-linear computations, the corresponding input
variables should be used).</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfelfd">rfelfd</a></font>
<br><font id="definition">Mnemonics: Response Function with respect to the ELectric FielD </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<p>
<br><font id="title"><a name="rf1elfd">rf1elfd</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 1st mixed perturbation : ELectric FielD </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf2elfd">rf2elfd</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 2nd mixed perturbation : ELectric FielD </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf3elfd">rf3elfd</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 3rd mixed perturbation : ELectric FielD </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>

<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
Turns on electric field response
function calculations (or non-linear computation, including the electric field
perturbation). Actually, such calculations
requires first the non-self-consistent calculation
of derivatives with respect to k, independently of the
electric field perturbation itself.
<br>
Only <a href="varrf.html#rfelfd">rfelfd</a> 
is compatible with both norm-conserving pseudopotentials as well as PAW. Higher mixed
perturbations can be used only with norm-conserving pseudopotentials.
<ul>
<li>0=>no electric field perturbation</li>
<li>1=>full calculation, with first the
    derivative of ground-state wavefunction with
    respect to k (d/dk calculation), by a
    non-self-consistent calculation, then the generation of
    the first-order response to an homogeneous
    electric field</li>
<li>2=>only the derivative of ground-state wavefunctions with
    respect to k</li>
<li>3=>only the generation of the first-order response
    to the electric field,
    assuming that the data on derivative of ground-state
    wavefunction with respect to k is available on disk.</li>
</ul>
(Note : because the tolerances to be used for derivatives or
homogeneous electric field are different, one often does the
calculation of derivatives in a separate dataset, followed by
calculation of electric field response as well as phonon.
<br>The options 2 and 3 proves useful in that context ;
also, in case a scissor shift is to be used,
it is usually not applied for the d/dk response). </font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfmeth">rfmeth</a></font>
<br><font id="definition">Mnemonics: Response Function METHod </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 1.</font>
<br><font id="text">
<p>
Selects method used in
response function calculations. Presently, only 1
is allowed. </font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfphon">rfphon</a></font>
<br><font id="definition">Mnemonics: Response Function with respect to PHONons </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<p>
<br><font id="title"><a name="rf1phon">rf1phon</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 1st mixed perturbation : PHONons </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf2phon">rf2phon</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 2nd mixed perturbation : PHONons </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>
<br><font id="title"><a name="rf3phon">rf3phon</a></font>
<br><font id="definition">Mnemonics: non-linear Response Function, 3rd mixed perturbation : PHONons </font>
<br><font id="category">Characteristic: NON-LINEAR  </font>
<p>

<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
It must be equal to 1
to run phonon response function calculations, or to include some phonon perturbation
in non-linear computations.   </font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="rfstrs">rfstrs</a></font>
<br><font id="definition">Mnemonics: Response Function with respect to STRainS </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
Used to run strain response-function
calculations (e.g. needed to get elastic constants). Define, with
<a href="varrf.html#rfdir">rfdir</a>, the set of perturbations.
<ul>
<li>0=>no strain perturbation</li>
<li>1=>only uniaxial strain(s) (ipert=natom+3 is activated)</li>
<li>2=>only shear strain(s) (ipert=natom+4 is activated)</li>
<li>3=>both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated)</li>
</ul>
See the possible restrictions on the use of strain perturbations, in the
<a href="../users/respfn_help.html#1">respfn_help file</a>.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="rfuser">rfuser</a></font>
<br><font id="definition">Mnemonics: Response Function, USER-defined  </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0. </font>
<br><font id="text">
<p>
Available to the developpers, to activate
the use of ipert=natom+5 and ipert=natom+6, two sets of perturbations
that the developpers can define.
<br>
<ul>
<li>0=>no computations for ipert=natom+5 or ipert=natom+6</li>
<li>1=>response with respect to perturbation natom+5 will be computed </li>
<li>2=>response with respect to perturbation natom+6 will be computed </li>
<li>3=>responses with respect to perturbations natom+5 and natom+6 will be computed </li>
</ul>
<p>In order to define and use correctly the new perturbations,
the developper might have to include code lines or additional routines
at the level of the following routines :
cgwf3.f, chkph3.f, dyout3.f, d2sym3.f, eneou3.f, eneres3.f, gath3.f, insy3.f,
loper3.f, mkcor3.f, nstdy3.f, nstwf3.f, respfn.f,
scfcv3.f, syper3.f, vloca3.f, vtorho3.f, vtowfk3.f, wings3.f, .
In these routines, the developper should pay a particular
attention to the rfpert array, defined in the routine respfn.f ,
as well as to the ipert local variable.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="sciss">sciss</a></font>
<br><font id="definition">Mnemonics: SCISSor operator </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>, <a href="../users/abinit_help.html#energy">ENERGY</a> </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
It is the value of the "scissors operator", the
shift of conduction band eigenvalues,
used in response function calculations.
<br>Can be specified in Ha (the default), Ry, eV or Kelvin, since
<b>ecut</b> has the
'<a href="../users/abinit_help.html#dimensions">ENERGY</a>' characteristics.
(1 Ha=27.2113845 eV)
<br>Typical use is for response to electric field (<a href="varrf.html#rfelfd">rfelfd</a>=3),
but NOT for d/dk (<a href="varrf.html#rfelfd">rfelfd</a>=2) and phonon responses.</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="smdelta">smdelta</a></font>
<br><font id="definition">Mnemonics: SMeared DELTA function </font>
<br><font id="category">Characteristic: <a href="../users/abinit_help.html#respfn">RESPFN</a>  </font>
<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 0</font>
<br><font id="text">
<p>
When <b>smdelta</b> in non-zero, it will trigger the calculation of the imaginary part of the second-order electronic eigenvalues, which can be related to the electronic lifetimes. The delta function is evaluated using:
<br>
<ul>
<li> when <b>smdelta</b> == 1, Fermi-Dirac smearing : 0.25_dp/(cosh(xx/2.0_dp)**2 </li>
<li> when <b>smdelta</b> == 2, Cold smearing by Marzari using the parameter a=-.5634 (minimization of the bump): exp(-xx2)/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx))) </li>
<li> when <b>smdelta</b> == 3, Cold smearing by Marzari using the parameter a=-.8165 (monotonic function in the tail): as 2 but different a </li>
<li> when <b>smdelta</b> == 4, Smearing of Methfessel and Paxton (PRB40,3616(1989)) with Hermite polynomial of degree 2, corresponding to "Cold smearing" of N. Marzari with a=0 (so, same smeared delta function as smdelta=2, with different a). </li> 
<li> when <b>smdelta</b> == 5, Gaussian smearing :  1.0d0*exp(-xx**2)/sqrt(pi) </li>
</ul>
</font>

<br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<br><font id="title"><a name="td_maxene">td_maxene</a></font>
<br><font id="definition">Mnemonics: Time-Dependent dft : MAXimal kohn-sham ENErgy difference </font>
<br><font id="category">Characteristic: TDDFT  </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.0</font>
<br><font id="text">
<p>
The Matrix to be diagonalized in the Casida framework
(see "Time-Dependent Density Functional Response Theory of Molecular
 systems: Theory, Computational Methods, and Functionals", by M.E. Casida,
 in Recent Developments and Applications of Modern Density Functional
 Theory, edited by J.M. Seminario (Elsevier, Amsterdam, 1996).)
is a NxN matrix, where, by default, N is the product of
the number of occupied states by the number of unoccupied states.
<br>
The input variable <b>td_maxene</b> allows to diminish N : it selects
only the pairs of occupied and unoccupied states for which the
Kohn-Sham energy difference is less than <b>td_maxene</b>.
The default value 0.0 means that all pairs are taken into account.
<br>See <a href="varrf.html#td_mexcit">td_mexcit</a> for an alternative
way to decrease N.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<br><font id="title"><a name="td_mexcit">td_mexcit</a></font>
<br><font id="definition">Mnemonics: Time-Dependent dft : Maximal number of EXCITations </font>
<br><font id="category">Characteristic: TDDFT  </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.</font>
<br><font id="text">
<p>
The Matrix to be diagonalized in the Casida framework
(see "Time-Dependent Density Functional Response Theory of Molecular
 systems: Theory, Computational Methods, and Functionals", by M.E. Casida,
 in Recent Developments and Applications of Modern Density Functional
 Theory, edited by J.M. Seminario (Elsevier, Amsterdam, 1996).)
is a NxN matrix, where, by default, N is the product of
the number of occupied states by the number of unoccupied states.
<br>
The input variable <b>td_mexcit</b> allows to diminish N : it selects
the first <b>td_mexcit</b> pairs of occupied and unoccupied states, ordered
with respect to increasing Kohn-Sham energy difference.
However, when <b>td_mexcit</b> is zero, all pairs are allowed.
<br>See <a href="varrf.html#td_mexcit">td_maxene</a> for an alternative
way to decrease N.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a>

<script type="text/javascript" src="list_internal_links.js"> </script>

</body>
</html>



